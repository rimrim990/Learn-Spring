# 스프링 MVC - 백엔드 핵심 기술 1
- 동시 요청 - 멀티 쓰레드

## 쓰레드
- 애플리케이션 코드를 하나하나 순차적으로 실행하는 것은 쓰레드
- 자바 메인 메서드를 처음 실행하면 main 이라는 이름의 쓰레드가 실행
- 쓰레드가 없다면 자바 애플리케이션 실행이 불가능
- 쓰레드는 한 번에 하나의 코드 라인만 수행
- 동시 처리가 필요하면 쓰레드를 추가로 생성

## 요청마다 쓰레드 생성
### 장점
- 동시 요청을 처리할 수 있다
- 리소스 (CPU, 메모리) 가 허용할 때 까지 처리가능
- 하나의 쓰레드가 지연 되어도, 나머지 쓰레드는 정상 동작한다

### 단점
- 쓰레드는 생성 비용이 매우 비싸다
  - 고객의 요청이 올 때 마다 쓰레드를 생성하면, 응답 속도가 느려진다 (생성하는 데에도 시간이 소요됨)
- 쓰레드는 컨텍스트 스위칭 비용이 발생한다
- 쓰레드 생성에 제한이 없다
  - 고객 요청이 너무 많이 오면 CPU, 메모리 임계점을 넘어 서버가 죽을 수 있다

### 단점 보완 - 쓰레드 
- 쓰레드 풀에 미리 쓰레드를 생성해놓고, 필요할 때 가져가 사용한다
- 쓰레드 풀에 존재하는 쓰레드보다 더 많은 요청이 들어오면, 처리할 수 없는 요청들은 대기하거나 거절된다
- 쓰레드 풀의 적정 숫자
  - 애플리케이션 로직의 복잡도, CPU, 메모리, IO 리소스 상황에 따라 모두 다름
  - 최대한 실제 서비스와 유사하게 성능 테스트 시도 (ex. nGrinder)

## WAS 의 멀티 쓰레드 지원
- 멀티 쓰레드에 대한 부분은 WAS 가 처리
- 개발자가 멀티 쓰레드 관련 코드를 신경쓰지 않아도 됨
- 개발자는 마치 싱글 쓰레드 프로그래밍을 하듯이 편리하게 소스 코드를 개발
- 멀티 쓰레드 환경이므르 싱글톤 객체 (서블릿, 스프링 빈) 는 주의해서 사용